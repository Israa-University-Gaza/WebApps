@using System.Data
@model IsraaSystem.Core.Classic.HumanResource.ManualFingerprint.ManualFingerprintVM

@{
    Layout = null;
}



    <div id="manual-fingerprints">
        <div id="refresh-list"></div>
        @if (TempData["toast-msg"] != null)
        {
            int status = Convert.ToInt32(TempData["toast-msg"].ToString().Split(';')[0]);
            String msg = TempData["toast-msg"].ToString().Split(';')[1];
            <script type="text/javascript">
            showToast("@msg", "@((status > 0) ? "success":"error")");
            </script>
        }
        @{
            AjaxOptions opt = new AjaxOptions
            {
                InsertionMode = InsertionMode.ReplaceWith,
                HttpMethod = "POST",
                UpdateTargetId = "manual-fingerprints"
            };
        }

        @using (Ajax.BeginForm("List", null, opt, new { @id = "form-manual-fingerprint" }))
        {
            <div class="form">
                <div class="form-horizontal">
                    @Html.AntiForgeryToken()
                    <div class="form-body">
                        <div class="form-group">
                            <label class="col-md-2 control-label">الموظف</label>
                            <div class="col-md-3">
                                @Html.TextBoxFor(model => model.filter.EmployeeName, new { @class = "form-control", placeholder = "اكتب اسم او رقم الموظف هنا للبحث ..." })
                            </div>

                            <label class="col-md-2 control-label">نوع البصمة</label>
                            <div class="col-md-2">
                                @Html.DropDownListFor(model => model.filter.FingerprintTypeID, new SelectList(Model.filter.FingerprintTypes, "Value", "Text"), "جميع الانواع", new { @class = "form-control input-change" })
                            </div>

                            <div class="col-md-2">
                                <button type="submit" class="btn blue">تصفية</button>
                            </div>
                            <div class="col-md-1">
                                @Html.DropDownListFor(model => model.pagging.pageSize, new SelectList(new Dictionary<string, int> { { "25", 25 }, { "50", 50 }, { "75", 75 }, { "100", 100 } }, "Key", "Value"), new { @class = "form-control pull-right input-change" })
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-md-2 control-label">الفرع</label>
                            <div class="col-md-2">
                                @Html.DropDownListFor(model => model.filter.BranchID, new SelectList(Model.filter.Branches, "Value", "Text"), "جميع الفروع", new { @class = "form-control input-change" })
                            </div>
                            <label class="col-md-2 control-label">حالة البصمة</label>
                            <div class="col-md-2">
                                @Html.DropDownListFor(model => model.filter.AccreditationStatusID, new SelectList(Model.filter.AccreditationStatuses, "Value", "Text"), "جميع الحالات", new { @class = "form-control input-change" })
                            </div>
                            <div class="col-md-2">
                                @Html.TextBoxFor(model => model.filter.DateFrom, new { @class = "form-control date-picker text-center", placeholder = "من" })
                            </div>
                            <div class="col-md-2">
                                @Html.TextBoxFor(model => model.filter.DateTo, new { @class = "form-control date-picker text-center", placeholder = "إلى" })
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <br />

            if (Model.data != null && Model.data.Rows.Count > 0)
            {
                <div class="row">
                    <div class="col-md-2">
                        <button type="submit" class="btn blue" title="اعتماد الكل">اعتماد المحدد</button>
                        @*<a href="/HumanResource/ManualFingerprint/AccrediateAll/@Model" data-ajax="true" data-ajax-method="POST" data-ajax-mode="replace-with" data-ajax-update="#refresh-list" class="btn blue">اعتماد الكل</a>*@
                        @*@Html.ActionLink("اعتماد الكل", "AccrediateAll",)*@
                    </div>
                </div>
                <table class="table table-striped table-hover">
                    <thead>
                        <tr>
                            <th class="wp3"><input type="checkbox" onClick="toggle(this)" title="تحديد الكل" /></th>
                            <th class="wp3">#</th>
                            <th class="wp12 text-center">اسم الموظف</th>
                            <th class="wp10 text-center">نوع البصمة</th>
                            <th class="wp10 text-center">الفرع</th>
                            <th class="wp10 text-center">تاريخ البصمة</th>
                            <th class="wp10 text-center">ساعة البصمة</th>
                            <th class="wp10 text-center">حالة البصمة</th>
                            <th class="wp15"></th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (DataRow row in Model.data.Rows)
                        {
                            <tr>
                                <td><input type="checkbox" name="foo" value="@row["ID"]"></td>
                                <td>@row["RowNo"]</td>
                                <td class="text-center">@row["EmployeeName"]</td>
                                <td class="text-center">@row["FingerprintType"]</td>
                                <td class="text-center">@row["Branch"]</td>
                                <td class="text-center">@row["FingerprintDate"]</td>
                                <td class="text-center">@row["FingerprintTime"]</td>
                                <td class="text-center">@row["FingerPrintStatus"]</td>
                                <td class="text-center">
                                    @if (row["IsAccredit"].ToString() == "0")
                                    {
                                        <a href="/HumanResource/ManualFingerprint/Accreditation/@row["ID"]" data-toggle="tooltip" data-placement="top" title="قبول" class="btn btn-sm btn-success" data-ajax="true" data-ajax-method="POST" data-ajax-mode="replace-with" data-ajax-update="#refresh-list"><i class="fa fa-check"></i> قبول</a>
                                        <a href="/HumanResource/ManualFingerprint/Rejection/@row["ID"]" data-toggle="tooltip" data-placement="top" title="رفض" class="btn btn-sm btn-primary" data-ajax="true" data-ajax-method="POST" data-ajax-mode="replace-with" data-ajax-update="#refresh-list"><i class="fa fa-ban"></i> </a>
                                        <a href="/HumanResource/ManualFingerprint/Delete/@row["ID"]" data-toggle="tooltip" data-placement="top" title="حذف" class="btn btn-sm btn-danger confirm" data-title="حذف البصمة" data-msg="هل أنت متأكد من أنك تود حذف البصمة ؟" data-action="حذف" data-ajax-update="#refresh-list"><i class="fa fa-times"></i> </a>
                                        <a href="/HumanResource/ManualFingerprint/Details/@row["ID"]" data-toggle="tooltip" data-placement="top" title="تفاصيل" class="btn btn-sm btn-primary pop-up-lg"><span class="fa fa-list"></span></a>

                                    }
                                    else
                                    {
                                        if (row["AccreditationStatusID"].ToString() != "0")
                                        {
                                            <a href="/HumanResource/ManualFingerprint/Apply/@row["ID"]" class="btn btn-sm btn-success" data-ajax="true" data-ajax-method="POST" data-ajax-mode="replace-with" data-ajax-update="#refresh-list"><i class="fa fa-check"></i> تنفيذ</a>
                                            if (row["FingerprintTypeID"].ToString() == "1" || row["FingerprintTypeID"].ToString() == "2")
                                            {
                                                <a href="/HumanResource/ManualFingerprint/DeAccredit/@row["ID"]" class="btn btn-sm btn-success" data-ajax="true" data-ajax-method="POST" data-ajax-mode="replace-with" data-ajax-update="#refresh-list"><i class="fa fa-check"></i> الغاء اعتماد</a>

                                            }
                                        }
                                        else
                                        {
                                            <a class="btn btn-sm btn-success" data-toggle="tooltip" data-placement="top" title="قبول" disabled='disabled'><i class="fa fa-check"></i> </a>
                                        }
                                        <a class="btn btn-sm btn-primary" data-toggle="tooltip" data-placement="top" title="رفض" disabled='disabled'><i class="fa fa-ban"></i> </a>
                                        <a class="btn btn-sm btn-danger" data-toggle="tooltip" data-placement="top" title="حذف" disabled='disabled'><i class="fa fa-times"></i></a>
                                        <a href="/HumanResource/ManualFingerprint/Details/@row["ID"]" data-toggle="tooltip" data-placement="top" title="تفاصيل" class="btn btn-sm btn-primary pop-up-lg"><span class="fa fa-list"></span></a>
                                    }
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>

                @Html.Partial("_paging", Model.pagging)
            }
            else
            {
                <div class="alert alert-info alert-dismissible text-center" role="alert">
                    <span>لا يوجد بيانات لعرضها</span>
                </div>
            }
        }
    </div>

@*@section PageScripts{
    <script language="JavaScript">
        function toggle(source) {
            alert('dddf');
            checkboxes = document.getElementsByName('foo');
            for (var i = 0, n = checkboxes.length; i < n; i++) {
                checkboxes[i].checked = source.checked;
            }
        }
    </script>
}*@