
@using System.Data
@model IsraaSystem.Core.Classic.HumanResource.Document.EmployeeDocumentsVM

@{
  Layout = null;
}


@if (TempData["toast-msg"] != null)
{
  int status = Convert.ToInt32(TempData["toast-msg"].ToString().Split(';')[0]);
  String msg = TempData["toast-msg"].ToString().Split(';')[1];
  <script type="text/javascript">
    showToast("@msg", "@((status > 0) ? "success":"error")");
  </script>
}
@{
  AjaxOptions opt = new AjaxOptions
  {
    InsertionMode = InsertionMode.ReplaceWith,
    HttpMethod = "POST",
    UpdateTargetId = "employee-document"
  };
}






<div id="employee-page">
  <script type="text/javascript">
    setMenu('#menu-employee-home');
  </script>
  <div class="row">
    <div class="col-md-12">
      <div class="portlet light bordered">
        <div class="portlet-title tabbable-line">
          <div class="caption caption-md">
            <i class="icon-globe theme-font hide"></i>
            <span class="caption-subject font-blue-madison bold uppercase">ملف الموظف</span>
          </div>

        </div>
        <div class="portlet-body">
          <div id="employee-document">
            <div id="refresh-list"></div>


            @using (Ajax.BeginForm("ProfileListAfter", null, opt, new { @id = "form-employee-document" }))
            {
              <div class="form">
                <div class="form-horizontal">
                  @Html.AntiForgeryToken()
                  <div class="form-body">
                    <div class="form-group">

                      @Html.HiddenFor(model => model.filter.EmployeeName, new { @class = "form-control text-center", placeholder = "رقم أو اسم الموظف" })

                      <label class="col-md-2 control-label">نوع المستند</label>
                      <div class="col-md-3">
                        @Html.DropDownListFor(model => model.filter.DocumentTypeID, new SelectList(Model.filter.DocumentTypes, "Value", "Text"), "أنواع المستندات", new { @class = "form-control" })
                      </div>
                      <div class="col-md-1">
                        <button type="submit" class="btn blue">تصفية</button>
                      </div>
                      <div class="col-md-2">
                        @Html.DropDownListFor(model => model.pagging.pageSize, new SelectList(new Dictionary<string, int> { { "25", 25 }, { "50", 50 }, { "75", 75 }, { "100", 100 } }, "Key", "Value"), new { @class = "form-control pull-right", onchange = "$('#current-page').val('1');$(this).submit();" })
                      </div>
                      <div class="col-md-3">
                        <a  href="/HumanResource/EmployeeDocument/Add?EmployeeID=@Model.filter.EmployeeID" class="btn pull-right  btn-success pop-up-lg">
                          <i class="fa fa-plus-square"></i>
                          <span>إضافة مستند</span>
                        </a>
                      </div>

                    </div>

                  </div>
                </div>
                <br />
                @if (Model.data != null && Model.data.Rows.Count > 0)
                {
                  <table class="table table-striped table-hover">
                    <thead>
                      <tr>
                        <th class="wp5">#</th>
                        @*<th class="wp20">الموظف</th>*@
                        <th class="wp20 text-center">المستند</th>
                        <th class="wp15 text-center">عدد الأوراق</th>
                        <th class="wp15 text-center">تاريخ الإضافة</th>
                        <th class="wp8 text-center"></th>
                      </tr>
                    </thead>
                    <tbody>
                      @foreach (DataRow row in Model.data.Rows)
                      {
                        <tr>
                          <td>@row["RowNo"]</td>
                          @*<td><a href="/HumanResourse/Employee/Index/@row["EmployeeID"]">@row["EmployeeName"]</a></td>*@
                          <td class="text-center"><a href="/Uploads/Employees/Documents/@row["DocumentURL"]">@row["DocumentType"]</a></td>
                          <td class="text-center">@row["DocumentCount"]</td>
                          <td class="text-center">@row["InsertDate"]</td>

                          <td class="text-center">
                            <a href="/HumanResource/EmployeeDocument/Delete/@row["ID"]" class="btn btn-sm btn-danger confirm" data-title="حذف مستند" data-msg="هل أنت متأكد من أنك تود حذف المستند ؟" data-action="حذف" data-ajax-update="#refresh-list"><span class="fa fa-times"></span></a>
                          </td>
                        </tr>
                      }
                    </tbody>
                  </table>
                  @Html.Partial("_paging", Model.pagging)
                }
                else
                {
                  <div class="alert alert-info alert-dismissible text-center" role="alert">
                    <span>لا يوجد بيانات لعرضها</span>
                  </div>
                }
              </div>
            }
          </div>

        </div>
      </div>
    </div>
  </div>
</div>